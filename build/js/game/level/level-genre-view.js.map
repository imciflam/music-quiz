{"version":3,"file":"level-genre-view.js","sources":["js/util.js","js/view.js","js/game/level/level-genre-view.js"],"sourcesContent":["export const createElement = (template) => {\n  const outer = document.createElement(`div`);\n  outer.innerHTML = template;\n  return outer.firstElementChild;\n};\n\nexport const $$ = (selector, scope = window.document) => {\n  return scope.querySelector(selector);\n};\n\nconst appElement = $$(`.app`);\n\nexport const changeView = (view) => {\n  appElement.replaceChild(view.element, $$(`section.main`));\n};\n\n\nexport const $on = (eventName, callback, el = appElement) => {\n  el.addEventListener(eventName, (evt) => {\n    callback(evt);\n  });\n};\n\nexport const $trigger = (eventName, data = null) => {\n  let customEvent = new CustomEvent(eventName, {detail: data});\n  appElement.dispatchEvent(customEvent);\n};\n\n","import { createElement } from \"./util\";\n\nexport default class AbstractView {\n  get template() {\n    throw new Error(`Define template for view`);\n  }\n\n  render() {\n    return createElement(this.template.trim());\n  }\n\n  get element() {\n    if (!this._element) {\n      this._element = this.render();\n      this.bind(); //bind to this\n    }\n    return this._element;\n  }\n}\n","import AbstractView from '../../view';\nimport {$$, $on, $trigger} from '../../util';\n\nexport default class LevelGenreView extends AbstractView {\n  constructor(level) {\n    super();\n    this.level = level;\n  }\n\n  get template() {\n    const {title, questions} = this.level;\n\n    const questionsTemplate = (data) => {\n      return data.reduce((string, it, index) => {\n        const n = index++;\n        const itemTemplate = `\n<div class=\"genre-answer\">\n  <div class=\"player-wrapper\">\n    <div class=\"player\">\n      <audio src=\"${it.src}\"></audio>\n      <button class=\"player-control player-control--play\"></button>\n      <div class=\"player-track\">\n        <span class=\"player-status\"></span>\n      </div>\n    </div>\n  </div>\n  <input type=\"checkbox\" name=\"answer\" value=\"answer-${n}\" id=\"a-${n}\">\n  <label class=\"genre-answer-check\" for=\"a-${n}\"></label>\n</div>`;\n        return string + itemTemplate;\n      }, ``);\n    };\n\n    return `\n<section class=\"main main--level main--level-genre\">\n  <div class=\"main-wrap\">\n    <h2 class=\"title\">${title}</h2>\n    <form class=\"genre\">\n\n      ${questionsTemplate(questions)}\n\n      <button class=\"genre-answer-send\" type=\"submit\" disabled>Ответить</button>\n    </form>\n  </div>\n</section>`.trim();\n  }\n\n  bind() {\n    const answerButton = $$(`.genre-answer-send`, this.element);\n\n    const checkboxes = [...this.element.querySelectorAll(`.genre-answer input[type=\"checkbox\"]`)];\n\n    checkboxes.forEach((checkbox) => {\n      $on(`change`, () => {\n        if (checkboxes.some((it) => it.checked)) {\n          answerButton.removeAttribute(`disabled`);\n        } else {\n          answerButton.setAttribute(`disabled`, `disabled`);\n        }\n      }, checkbox);\n    });\n\n    $on(`click`, (evt) => this.handlerAnswer(evt), answerButton);\n  }\n\n  handlerAnswer(evt) {\n    evt.preventDefault();\n    const answers = [...evt.target.form.elements.answer];\n    $trigger(`answerGenre`, answers);\n  }\n}\n"],"names":[],"mappings":";;;AAAO,MAAM,aAAa,GAAG,CAAC,QAAQ,KAAK;EACzC,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;EAC5C,KAAK,CAAC,SAAS,GAAG,QAAQ,CAAC;EAC3B,OAAO,KAAK,CAAC,iBAAiB,CAAC;CAChC,CAAC;;AAEF,AAAO,MAAM,EAAE,GAAG,CAAC,QAAQ,EAAE,KAAK,GAAG,MAAM,CAAC,QAAQ,KAAK;EACvD,OAAO,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;CACtC,CAAC;;AAEF,MAAM,UAAU,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;;AAE9B,AAAO,AACL,AAA0D,AAC1D;;;AAGF,AAAO,MAAM,GAAG,GAAG,CAAC,SAAS,EAAE,QAAQ,EAAE,EAAE,GAAG,UAAU,KAAK;EAC3D,EAAE,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC,GAAG,KAAK;IACtC,QAAQ,CAAC,GAAG,CAAC,CAAC;GACf,CAAC,CAAC;CACJ,CAAC;;AAEF,AAAO,MAAM,QAAQ,GAAG,CAAC,SAAS,EAAE,IAAI,GAAG,IAAI,KAAK;EAClD,IAAI,WAAW,GAAG,IAAI,WAAW,CAAC,SAAS,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC,CAAC;EAC7D,UAAU,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;CACvC,CAAC;;ACxBa,MAAM,YAAY,CAAC;EAChC,IAAI,QAAQ,GAAG;IACb,MAAM,IAAI,KAAK,CAAC,CAAC,wBAAwB,CAAC,CAAC,CAAC;GAC7C;;EAED,MAAM,GAAG;IACP,OAAO,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC;GAC5C;;EAED,IAAI,OAAO,GAAG;IACZ,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;MAClB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;MAC9B,IAAI,CAAC,IAAI,EAAE,CAAC;KACb;IACD,OAAO,IAAI,CAAC,QAAQ,CAAC;GACtB;CACF;;ACfc,MAAM,cAAc,SAAS,YAAY,CAAC;EACvD,WAAW,CAAC,KAAK,EAAE;IACjB,KAAK,EAAE,CAAC;IACR,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;GACpB;;EAED,IAAI,QAAQ,GAAG;IACb,MAAM,CAAC,KAAK,EAAE,SAAS,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC;;IAEtC,MAAM,iBAAiB,GAAG,CAAC,IAAI,KAAK;MAClC,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,EAAE,EAAE,KAAK,KAAK;QACxC,MAAM,CAAC,GAAG,KAAK,EAAE,CAAC;QAClB,MAAM,YAAY,GAAG,CAAC;;;;kBAIZ,EAAE,EAAE,CAAC,GAAG,CAAC;;;;;;;qDAO0B,EAAE,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;2CAC1B,EAAE,CAAC,CAAC;MACzC,CAAC,CAAC;QACA,OAAO,MAAM,GAAG,YAAY,CAAC;OAC9B,EAAE,CAAC,CAAC,CAAC,CAAC;KACR,CAAC;;IAEF,OAAO,CAAC;;;sBAGU,EAAE,KAAK,CAAC;;;MAGxB,EAAE,iBAAiB,CAAC,SAAS,CAAC,CAAC;;;;;UAK3B,CAAC,CAAC,IAAI,EAAE,CAAC;GAChB;;EAED,IAAI,GAAG;IACL,MAAM,YAAY,GAAG,EAAE,CAAC,CAAC,kBAAkB,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;;IAE5D,MAAM,UAAU,GAAG,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC,oCAAoC,CAAC,CAAC,CAAC,CAAC;;IAE9F,UAAU,CAAC,OAAO,CAAC,CAAC,QAAQ,KAAK;MAC/B,GAAG,CAAC,CAAC,MAAM,CAAC,EAAE,MAAM;QAClB,IAAI,UAAU,CAAC,IAAI,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,OAAO,CAAC,EAAE;UACvC,YAAY,CAAC,eAAe,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;SAC1C,MAAM;UACL,YAAY,CAAC,YAAY,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC;SACnD;OACF,EAAE,QAAQ,CAAC,CAAC;KACd,CAAC,CAAC;;IAEH,GAAG,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,GAAG,KAAK,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE,YAAY,CAAC,CAAC;GAC9D;;EAED,aAAa,CAAC,GAAG,EAAE;IACjB,GAAG,CAAC,cAAc,EAAE,CAAC;IACrB,MAAM,OAAO,GAAG,CAAC,GAAG,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;IACrD,QAAQ,CAAC,CAAC,WAAW,CAAC,EAAE,OAAO,CAAC,CAAC;GAClC;CACF,;;,;;"}